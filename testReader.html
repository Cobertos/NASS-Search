<!DOCTYPE html>
<html>
<head>
<title>Test Reader</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="./nassFileStructure.js"></script>
<script type="text/javascript">
"use strict";

function readSASFile(view)
{
	var sasInfo = {};
	document.sasInfo = sasInfo;
	//Header
	sasInfo.header = sasTools.readBitmap(view, 0, sasTools.dbHeaderBitmap);
	//Pages in the header
	sasInfo.pages = [];
	for(var pg=0; pg<(sasInfo.header.pageCount*sasInfo.header.pageSize); pg+=sasInfo.header.pageSize)
	{
		var page = sasTools.readBitmap(view, 1024+pg, sasTools.pageBitmap);
		sasInfo.pages.push(page);
	}
}


$(function(){
$("#submitButton").on("click", function(e){
	//Read in the file
	var file = $("#submitFile")[0].files[0];
	var fr = new FileReader();
	$(fr).on("load", function(e){
		var view = new Uint8Array(e.target.result);
		document.sasRead = view;
		readSASFile(view);
	});
	$(fr).on("error", function(e){
		console.log("Not loaded");
	});
	fr.readAsArrayBuffer(file);
});
});

</script>
</head>

<body>
<input id="submitFile" type="file">
<input id="submitButton" type="button" value="Submit">
<table id="outputReport">
<tr><td>Field</td><td>Byte Pos</td><td>Byte Len</td><td>Value</td><td>Formatted Value</td><td>Compare<td></tr>
</table>
</body>

</html>